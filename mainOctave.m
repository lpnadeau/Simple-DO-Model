clear allplotTseries = 1 ;for nnc = 8 : 2 : 8    %%%%%%%%%%%%%%%% <-------------- Global Cooling Ncase=nnc   ;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% --->  Box ModelNyears  = 1500 ; dt = 10.*86400;t = 0:dt:Nyears*360*86400;tt1= 1;  tt2= size(t,2); clear yplot_tseries =1;% start with retuning psiS eqn with GCM% add back some horizontal diffusion and get rid of psiBG% bring Tfreeze =0  and adjust with FT  Tcool =  0.02+ 0.1* Ncase ; Tsurf   =  - 2.5 - Tcool   ;NoiseAmp   =  4.5E-4*(0.23 + Tcool) ;NoiseLag   =  15* 365. * 86400. ; T_00    =  14.5 ;T_0     =  T_00 - Tcool  ;  Fs      = - .93* .87e-08  ; FT      = -3.57* 1.4E-10 psibg   =  1.3e6   ;psiconst = 0.34*0.052; kappa_LL = 10.E-5  ;  kappa    = 4E-5  ;kappaconv= 3.e-2  ;freezPoint =  3.5;Wtanh      = 1./5.E-7   ;%%%%%%%%%%%%%%%%%%%%%%%%% Note: When convection is off could try having psi going in lower not upper layer% but this only really makes sense when using b_deep to compute MOC!%T = 25;dt = .1;Nt = T;A_S   = 1.E13*0.6  ;A_D   = 30.E13  ;A_0   = A_D;Lx    = 6000.E3 ; H_max = 4000;h       = 600.  ;delta   = 100.   ;f0      = 1.E-4 ;g       = 9.8;tauT    = 2.5*delta*86400;tauT_LL = 2.* 20.*(h/delta).* tauT ; %0.5*36500*86400;mu_ice  =    .3e11  ; %  units are m^3 of ice per second per K Ze4 Vo      =    5.E12   ;linloss = 0.E-9 ; % units are s^-1%Fs      = -7E-10  ; %6% Note: larger Fs leads to stable equlibrium state with ice, stable strat% and no AMOC, while smller Fs leads to equilibrium state with little ice,% convection and active AMOC. In between there seems to be a limit cycle (around Fs = -6.8e-10).L=3.33e5; % Latent heat of freezing [J/kg]%psibg = 5e6;%7e6; %"background" psi which is basically a placeorder for hor. mixing S_0= 35.5;P_0 = 1000.;rho_0 = 1035.1;%densjmd95(35.75,0, P_0); %revisity=zeros(7,length(t));freezerate=zeros(1,length(t)) ;% Initial conditionsy(1,1) = 1.1;%2.9     ; % Theta_s y(2,1) = 35.22; % S_sy(3,1) = 1.2;%2.95     ; % Theta_D y(4,1) = 35.18; % S_Dy(5,1) = 0.   ; % Vicey(6,1) = T_0  ; % T_0y(7,1) = S_0  ; % S_0%%%%%%%%%%%%%%%%%%%OctaveCore%%%%%%%%%%%%%%%%%%%if(Ncase==1)yyn = y(:,tt1:tt2);bSn = squeeze(b_S(tt1:tt2)');bDn = squeeze(b_D(tt1:tt2)');psin = squeeze(psi(tt1:tt2)');Hn = squeeze(H(tt1:tt2)');elseyyn(:,:,Ncase) = y(:,tt1:tt2);bSn(:,Ncase) = squeeze(b_S(tt1:tt2));bDn(:,Ncase) = squeeze(b_D(tt1:tt2));psin(:,Ncase) = squeeze(psi(tt1:tt2)');Hn(:,Ncase) = squeeze(H(tt1:tt2)');endsave('DiagsHovBox.mat','yyn','bSn','bDn','psin','Hn')%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%figure(1)tt1= 1;  tt2= size(t,2); t = 1E-3*(t(tt1:tt2)-t(tt1)) /(360*86400);if(plotTseries == 1)%%%%%%%%%%%%%%%%%%%%%%%%%%%%subplot(7,1,1)plot( t, yyn(5,tt1:tt2,Ncase) ,'LineWidth', 2,'color',[ 0.494        0.184        0.556]);hold onhold off%ylim([0 10E12])ylabel('Ice Volume (m^{3})')title('Box Model')%%%%%%%%%%%%%%%%%%%%%%%%%%%%ax1 = subplot(7,1,[2 3])%yyaxis left                %plot(x,y1)plot( t, yyn(3,tt1:tt2,Ncase),'-' ,'LineWidth', 2,'color',[  0.85        0.325        0.098]);hold onplot( t, yyn(1,tt1:tt2,Ncase),'-' ,'LineWidth', 2,'color',[     0        0.447        0.741]);hold off%ylim([-5 5])ylabel('Temperature (^{o}C)')pause(0.1)                  % see [3]%%%%%%%%%%%%%%%%%%%%%%%%%%%%subplot(7,1,[4 5])plot(  t, bDn(tt1:tt2,Ncase),'LineWidth', 2,'color',[  0.85        0.325        0.098]);hold onplot(  t, bSn(tt1:tt2,Ncase),'LineWidth', 2,'color',[     0        0.447        0.741]);hold onhold offylabel('Buoyancy (ms^{-2})')%ylim([0.02 0.03])%%%%%%%%%%%%%%%%%%%%%%%%%%%%ax1 = subplot(7,1,[6 7])plot(  t, 1E-6*psin(tt1:tt2,Ncase) ,'LineWidth', 2,'color',[ 0.494        0.184        0.556]);%ylim([-20 10])ylabel('MOC (Sv)')xlabel('time (kyr)')pause(0.1)                  % see [3]%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%nameF = ['tseries' num2str(0.1*Ncase) '.png']											  aa=18.;bb=16.;											  set(gcf,'PaperUnits','centimeters');set(gcf,'PaperSize',[aa bb]);set(gcf,'PaperPosition',[0 0 aa bb]);print('-dpng', nameF)  %%%%%%%% <-------------------- %%%%%%%%%%%%endendif(plotTseries == 1)%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% --->  Hovmollerload('DiagsHov.mat') TSurf = -0.1*(1:19);figure(33)clfdt = 10*86400;t = 0: dt/(360*86400) : dt*size(squeeze(yyn(1,:,1)),2)/(360*86400); t=1E-3*t;%subplot(2,1,1)pcolor(squeeze(yyn(1,:,:))');shading flat;colorbarcaxis([2 3.5])ylabel('Surface Temperature (^{o}C)')xlabel('Time (Kyrs)')title('Box Model : \Theta_N')ylim([0 20])  dt = 10*86400;t = 0: dt/(360*86400) : dt*size(squeeze(yyn(1,:,1)),2)/(360*86400); t=1E-3*t;  bbry2;colormap(cm_bbry);aa=18.;bb=18.;set(gcf,'PaperUnits','centimeters');set(gcf,'PaperSize',[aa bb]);set(gcf,'PaperPosition',[0 0 aa bb]);print('-dpng', 'param_space.png')  %%%%%%%% <-------------------- %%%%%%%%%%%%%%end